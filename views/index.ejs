<!DOCTYPE html>
<html>
  <head>
    <title>Your Diary</title>
    <style>
      .action-btn {
        padding: 4px 8px;
        margin: 2px;
        border-radius: 5px;
      }
      .edit-btn {
        background: #3498db;
        color: white;
      }
      .delete-btn {
        background: #e74c3c;
        color: white;
      }
      .public-btn {
        background: #2ecc71;
        color: white;
      }
      .private-btn {
        background: #f39c12;
        color: white;
      }
    </style>
  </head>
  <body>
    <h1>Your Diary Entries</h1>
    <a href="/entries/new %>" class="action-btn view-btn">Add New</a>

    <ul>
      <% if (entries.length === 0) { %>
      <li>No entries found.</li>
      <% } else { %> <% entries.forEach(entry => { %>
      <li>
        <strong><%= entry.title %></strong> - <%=
        entry.createdAt.toLocaleString() %><br />

        <!-- Public/Private toggle -->
        <% if (!entry.isPublic) { %>
        <form
          action="/entries/<%= entry._id %>/set-public"
          method="POST"
          style="display: inline"
        >
          <button type="submit" class="action-btn public-btn">
            Make Public
          </button>
        </form>
        <% } else { %>
        <span
          >Public:
          <a href="/share/<%= entry.shareId %>" target="_blank"
            >Share Link</a
          ></span
        >
        <form
          action="/entries/<%= entry._id %>/set-private"
          method="POST"
          style="display: inline"
        >
          <button type="submit" class="action-btn private-btn">
            Make Private
          </button>
        </form>
        <% } %>

        <!-- Delete -->
        <a href="/entries/<%= entry._id %>" class="action-btn view-btn">View</a>
        <a href="/entries/<%= entry._id %>/edit" class="action-btn edit-btn"
          >Edit</a
        >
        <form
          action="/entries/<%= entry._id %>/delete"
          method="POST"
          style="display: inline"
        >
          <button
            type="submit"
            class="action-btn delete-btn"
            onclick="return confirm('Delete this entry?')"
          >
            Delete
          </button>
        </form>
      </li>
      <% }) %> <% } %>
    </ul>
  </body>
</html>
